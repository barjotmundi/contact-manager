@model IEnumerable<ContactManager.Dtos.ContactDto>

@{
    ViewData["Title"] = "Contact Manager";
}

<header class="cm-header text-center my-5">
    <div class="d-inline-flex align-items-center gap-3">
        <i class="bi bi-person-lines-fill cm-logo-icon" aria-hidden="true"></i>
        <h1 class="cm-title mb-0">Contact Manager</h1>
    </div>

    <p class="cm-subtitle text-muted mt-2 mb-3">
        Your contacts, simplified.
    </p>
</header>

<main class="container cm-main pb-5">

    @* Global banner for server/AJAX errors *@
    @await Html.PartialAsync("_GlobalError")

    @* Anti-forgery token for AJAX POST/PUT/DELETE *@
    @Html.AntiForgeryToken()

    @* Search form: handles Enter + Search button via submit *@
    <form id="searchForm"
          class="cm-toolbar d-flex flex-column flex-md-row align-items-stretch align-items-md-center gap-2 mb-3"
          role="search">

        <div class="cm-search">
            <i class="bi bi-search cm-search-icon"></i>
            <input id="searchBox"
                   name="query"
                   class="form-control"
                   placeholder="Search contacts..."
                   aria-label="Search contacts" />
        </div>

        <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary">
                Search
            </button>

            <button id="addNewBtn" type="button" class="btn btn-success">
                + Add Contact
            </button>
        </div>
    </form>

    @* Table body is swapped by AJAX refresh() *@
    <div class="card cm-table-card">
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead>
                    <tr>
                        <th class="ps-4">Name</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th class="text-center pe-4">Actions</th>
                    </tr>
                </thead>
                <tbody id="contactsTbody">
                    @await Html.PartialAsync("_ContactList", Model)
                </tbody>
            </table>
        </div>
    </div>

    @* Modal for add + edit *@
    @await Html.PartialAsync("_ContactModal")

    @* Reused confirmations *@
    @await Html.PartialAsync("_ConfirmModal")

</main>

@section Scripts {
    <script type="module" src="~/js/contacts/index.js" asp-append-version="true"></script>
}
